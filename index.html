<!doctype html>
<html class="theme-next use-motion ">
<head>
<meta name="baidu-site-verification" content="wSBSaNtC6y" />

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>



  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.3"/>


    <meta name="description" content="Can't take my eyes off you" />



  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.3" />



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    analytics: {
      google: ''
    },
    sidebar: 'post'
  };
</script>




  <title> LOCATINO'S NOTES </title>
</head>

<body>
  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->

  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <div id="header" class="header">
      <div class="header-inner">
        <h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand">
      <span class="logo">
        <i class="icon-logo"></i>
      </span>
      <span class="site-title">LOCATINO'S NOTES</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<div class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/">
            <i class="menu-item-icon icon-home"></i> <br />
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            <i class="menu-item-icon icon-archives"></i> <br />
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            <i class="menu-item-icon icon-tags"></i> <br />
            標籤
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            <i class="menu-item-icon icon-about"></i> <br />
            關於
          </a>
        </li>
      
    </ul>
  

  
</div>


      </div>
    </div>

    <div id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <div id="posts" class="posts-expand">
    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/08/06/Alice-Where-Art-Thou/">
                Alice, Where Art Thou?
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-08-06
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/NONSENSE/">NONSENSE</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p style="text-align:center">Quaint child, old-fashioned Alice, lend your dream:<br>I would be done with modern story-spinners,<br>Follow with you the laughter and the gleam:<br>Weary I am, this night, of saints and sinners.<br>We have been friends since Lewis and old Tenniel<br>Housed you immortally in red and gold.<br>Come! Your naivete is a spring perennial:<br>Let me be young again before I am old.<br><br><br>You are a glass of youth: this night I choose<br>Deep in your magic labyrinths to stray,<br>Where rants the Red Queen in her splendid hues<br>And the Write Rabbit hurries on his way.<br>Let us once more adventure, hand in hand:<br>Give me belief again—— in Wonderland!<br></p>

<p style="text-align:right">——Vincent Starret, in <i>Brillig</i></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/08/03/playing-python-lambda/">
                玩转Python Lambda
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-08-03
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Memo/">Memo</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>最近在学习函数式编程，又想顺便学下大名鼎鼎的<strong>Python</strong> ，遂把<strong>The little schemer</strong>里的<strong>scheme</strong>代码全部用<strong>Python</strong>实现了一遍。<br>函数式编程的精髓当然是传说中的<strong>lambda</strong>表达式，本来打算用<strong>Python lambda</strong>实现<strong>scheme</strong>代码，没想到网上一查<strong>API</strong>，却发现<strong>Python lambda</strong>实在是做的弱到不行……不能缩进（一个<strong>lambda</strong>函数只能写在一行），只能用<strong>if…else…</strong>，只能写一条语句等等。</p>
<blockquote>
<p>“Why can’t lambda expressions contain statements?</p>
<p>Python lambda expressions cannot contain statements because Python’s syntactic framework can’t handle statements nested inside expressions. However, in Python, this is not a serious problem. Unlike lambda forms in other languages, where they add functionality, Python lambdas are only a shorthand notation if you’re too lazy to define a function.</p>
<p>Functions are already first class objects in Python, and can be declared in a local scope. Therefore the only advantage of using a lambda instead of a locally-defined function is that you don’t need to invent a name for the function – but that’s just a local variable to which the function object (which is exactly the same type of object that a lambda expression yields) is assigned!”</p>
</blockquote>
<p>为啥<strong>lambda</strong>表达式不能包含语句？</p>
<p>以上是<strong>Python</strong>官方<strong>FAQ</strong>给出的答复：<strong>lambda</strong>表达式就是给你偷懒少打几个字用的，不支持在语句中嵌套表达式。</p>
<p>基本上<strong>Python Lambda</strong>就应用在以下场景：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = lambda x, y: x + <span class="literal">y</span></span><br><span class="line"><span class="keyword">g</span> = lambda x: x + 1</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="literal">f</span>(1, 2))</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">g</span>(1))</span><br></pre></td></tr></table></figure></p>
<p>这匿名函数还tm有个名字。<br>或者你可以节约名字:<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print<span class="list">(<span class="list">(<span class="keyword">lambda</span> x, y: x + y)</span><span class="list">(<span class="number">1</span>, <span class="number">2</span>)</span>)</span></span><br><span class="line">print<span class="list">(<span class="list">(<span class="keyword">lambda</span> x: x + <span class="number">1</span>)</span><span class="list">(<span class="number">1</span>)</span>)</span></span><br></pre></td></tr></table></figure></p>
<p>是不是觉得还不如这样：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="number">1</span> + <span class="number">2</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="number">1</span> + <span class="number">1</span>)</span></span></span><br></pre></td></tr></table></figure></p>
<p>不得不说<strong>Python lambda</strong>简直是鸡肋。</p>
<p>但是，你注意到<strong>Python lambda</strong>支持<strong>if…else…</strong>语句了吗，<strong>scheme</strong>也只有<strong>cond…else</strong>这一种控制语句，却是非常优美的函数式<strong>PL</strong>。<br>所以我试着用<strong>if…else…</strong>来搞点名堂。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> x: <span class="keyword">True</span> <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure></p>
<p>上面的函数判断一个数是不是偶数，其中<strong>if…else…</strong>是<strong>Python lambda</strong>的标准用法。<br>冒号后面接返回值<strong>return-expression</strong>，接着是该返回值的条件<strong>cond-expression</strong>，接着<strong>else</strong>，然后是<strong>else</strong>的返回值。<br><strong>Python lambda</strong>总共以下2种写法，一种是不含<strong>if…else…</strong>的，一种是包含<strong>if…else…</strong>的：<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;args&gt;: &lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt;</span><br><span class="line">lambda &lt;args&gt;: &lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt; <span class="keyword">if</span> &lt;cond-<span class="keyword">expression</span>&gt; <span class="keyword">else</span> &lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt;</span><br></pre></td></tr></table></figure></p>
<p>第二条语句的<strong>“&lt; return-expression &gt; if &lt; cond-expression &gt; else &lt; return-expression &gt;”</strong> 整体也是一个<strong>return-expression</strong>。<br>所以我们可以在<strong>else</strong>后的<strong>return-expression</strong>中嵌套<strong>return-expression</strong>来完成复杂的条件判断语句：<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;args&gt;: &lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt; <span class="keyword">if</span> &lt;cond-<span class="keyword">expression</span>&gt; <span class="keyword">else</span> (&lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt; <span class="keyword">if</span> &lt;cond-<span class="keyword">expression</span>&gt; <span class="keyword">else</span> &lt;<span class="keyword">return</span>-<span class="keyword">expression</span>&gt;)</span><br></pre></td></tr></table></figure></p>
<p>提问！如果想要在匿名函数中做一些除了<strong>return-expression</strong>，其他事情（比如说<strong>print()</strong>）,应该怎么写？<br>确实不太好写，不过我还是想出了一个非常<strong>投机取巧</strong>的办法：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> x: <span class="keyword">True</span> <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">and</span> print(x) == <span class="keyword">None</span> <span class="keyword">else</span> x<span class="string">")</span></span><br></pre></td></tr></table></figure></p>
<p>上面这个函数不仅返回了<strong>x</strong>的值，并且还打印了<strong>x</strong>，这里我把需要执行的语句(<strong>print()</strong>)转换成了逻辑表达式，而且是一个永远为真的表达式，它一定会执行，并且对业务的逻辑判断没有影响。<br>前提是你必须准确的知道需要执行的语句的返回值，才能写出永远为真的表达式。再写一个例子：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x, <span class="keyword">l</span>: <span class="keyword">l</span> <span class="keyword">if</span> <span class="keyword">l</span>.insert(0,x) == None <span class="keyword">else</span> <span class="keyword">l</span></span><br></pre></td></tr></table></figure></p>
<p>上面这个函数把元素<strong>x</strong>插入到<strong>l</strong>的头部，并返回<strong>l</strong>。<br>通过这种<strong>投机取巧</strong>的办法我们可以大大扩充<strong>Python lambda</strong>的功能。</p>
<p><strong>Python lambda</strong>还可以返回异常：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x: <span class="function"><span class="title">TypeError</span><span class="params">(<span class="string">"x is zero."</span>)</span></span> <span class="keyword">if</span> x == <span class="number">0</span> <span class="keyword">else</span> <span class="number">5</span>/x</span><br></pre></td></tr></table></figure></p>
<p>提问！迭代（循环）怎么写？<br>问得好！迭代确实是一个难题，<strong>scheme</strong>这样没有迭代的语句是怎么实现迭代的？递归。<br>首先我们先用常规函数的递归实现迭代：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#求和递归版本</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_recur</span><span class="params">(l)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> len(l) == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> l[<span class="number">0</span>] + sum_recur(l[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment">#求和迭代版本</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum_iter</span><span class="params">(l)</span>:</span></span><br><span class="line">  sum = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> l:</span><br><span class="line">    sum += i</span><br><span class="line">  <span class="keyword">return</span> sum</span><br></pre></td></tr></table></figure></p>
<p>以上2个函数均实现了<strong>list l</strong>中元素求和，功能上是等价的。</p>
<p>但是匿名函数要递归调用自身难度很高。<br>以下可能有点高能，初学者慎入。<br>首先要知道，<strong>lambda</strong>表达式也是一个<strong>return-expression</strong>。所以我们还可以在<strong>lambda</strong>中返回<strong>lambda</strong>：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda <span class="tag">&lt;<span class="title">args</span>&gt;</span>: lambda <span class="tag">&lt;<span class="title">args</span>&gt;</span>: <span class="tag">&lt;<span class="title">return-expression</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>先看看下面这个函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span><span class="params">(f)</span>:</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">lambda</span> l:<span class="number">0</span> <span class="keyword">if</span> len(l) == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + f(f)(l[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">print(sum(sum)([<span class="number">1</span>,<span class="number">2</span>]))</span><br></pre></td></tr></table></figure></p>
<p>这个函数接受一个自身作为参数，返回值是一个求和函数，也就是实际的递归本体，即<strong>sum(sum) = lambda l:0 if len(l) == 0 else l[0] + sum(sum)(l[1:])</strong>,如此实现递归调用自身。<br>我们先把<strong>sum(f)</strong>转换成<strong>lambda</strong>函数：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def <span class="function"><span class="title">sum</span><span class="params">(f)</span></span>:</span><br><span class="line">  return lambda l:<span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span></span><br><span class="line"></span><br><span class="line">lambda f: lambda l:<span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span></span><br></pre></td></tr></table></figure></p>
<p>上述2个函数式功能是等价的,返回值都相同，只是一个有名字而已，匿名函数没有名字如何调用自身？也是通过函数的参数，并且直接使用自身的定义，所以我们可以令<strong>sum(sum)</strong>为：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">sum</span><span class="params">(lambda f: lambda l:<span class="number">0</span> if len(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span>)</span><br><span class="line">#第二个sum，也就是作为参数的sum已被等价的lambda替换，</span><br><span class="line">#现在我们再来替换第一个sum</span><br><span class="line">(lambda f: lambda l:<span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span>) (lambda f: lambda l:<span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span>)</span><br></pre></td></tr></table></figure></p>
<p>这就完成了匿名函数递归调用自身。测试：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g = (lambda f: lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span>) (lambda f: lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(l[<span class="number">1</span>:])</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(g([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span></span>)</span><br></pre></td></tr></table></figure>
<p>接下来优化一下~</p>
<p>注意到<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#<span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(x)</span></span></span><br><span class="line">#等价于</span><br><span class="line"><span class="id">#lambda</span> x: <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(x)</span></span></span><br><span class="line"></span><br><span class="line">#那么我们可以把上面出现的<span class="function"><span class="title">f</span><span class="params">(f)</span></span>都用参数替换，然后传一个lambda x: <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(x)</span></span>作为参数即可</span><br><span class="line">g = (lambda f: lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + (lambda x: <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(x)</span></span>)(l[<span class="number">1</span>:])) (lambda f: lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + (lambda x: <span class="function"><span class="title">f</span><span class="params">(f)</span><span class="params">(x)</span></span>)(l[<span class="number">1</span>:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = (lambda y: (lambda f:lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(l[<span class="number">1</span>:])</span></span>)(lambda x: <span class="function"><span class="title">y</span><span class="params">(y)</span><span class="params">(x)</span></span>))(lambda y: (lambda f:lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(l[<span class="number">1</span>:])</span></span>)(lambda x: <span class="function"><span class="title">y</span><span class="params">(y)</span><span class="params">(x)</span></span>))</span><br><span class="line">#注意：</span><br><span class="line">lambda f:lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(l[<span class="number">1</span>:])</span></span></span><br><span class="line">#此函数就是真正的业务递归过程，其他结构均是辅助，我们可以提取出来</span><br><span class="line">job = lambda f:lambda l: <span class="number">0</span> <span class="keyword">if</span> <span class="function"><span class="title">len</span><span class="params">(l)</span></span> == <span class="number">0</span> <span class="keyword">else</span> l[<span class="number">0</span>] + <span class="function"><span class="title">f</span><span class="params">(l[<span class="number">1</span>:])</span></span></span><br><span class="line"></span><br><span class="line">g = (lambda y: <span class="function"><span class="title">job</span><span class="params">(lambda x: y(y)</span><span class="params">(x)</span></span>))(lambda y: <span class="function"><span class="title">job</span><span class="params">(lambda x: y(y)</span><span class="params">(x)</span></span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(g([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span></span>)</span><br></pre></td></tr></table></figure></p>
<p>这个<strong>g</strong>就是传说中的上古神器<strong>Y-Combinator</strong>！它就是一个通用的匿名函数递归公式。</p>
<p>至此，我们已经把<strong>Python lambda</strong>的功能扩充的基本和普通函数差不多了（额，可能还差一点）。<br>而且所有函数全部一行完成，然而并没有什么卵用。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/21/Python-eval和ast-literal-eval/">
                Python eval和ast.literal_eval
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-21
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Memo/">Memo</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p><code>datamap = eval(raw_input(&#39;Provide some data here: &#39;)</code> means that you actually evaluate the code before you deem it to be unsafe or not. It evaluates the code as soon as the function is called. See also the dangers of <code>eval</code>.</p>
<p><code>ast.literal_eval</code> raises an exception if the input isn’t a valid Python datatype, so the code won’t be executed if it’s not.</p>
<p><strong>Use <code>ast.literal_eval</code> whenever you need <code>eval</code>.</strong> If you have Python expressions as an input that you want to evaluate, you shouldn’t (have them).</p>
<hr>
<p>简而言之一句话，<code>literal_eval</code>做了类型检查，如果参数无效的话就会报错，而<code>eval</code>不会。所以尽量使用<code>literal_eval</code>。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/06/The-Little-Book-of-Semaphores/">
                The Little Book of Semaphores
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-06
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Books/">Books</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p><img src="https://github.com/locatino/locatino.github.io/raw/master/images/book-the-little-book-of-semaphores.jpg" alt=""><br>本书教授了如何理解多线程执行和如何解决同步问题。尤其推荐给自学和初学者。<br>里面一步步教导读者解决一系列的经典和不那么经典的同步问题。内容非常有趣。<br>下载链接：<a href="http://www.greenteapress.com/semaphores/downey08semaphores.pdf" target="_blank" rel="external">http://www.greenteapress.com/semaphores/downey08semaphores.pdf</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/07/01/极端编程主义/">
                极端编程主义
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-07-01
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Translation/">Translation</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <pre><code>函数（<span class="built_in">Function</span>）太棒了。如果我们创造一门只有函数的语言会如何？
对象（<span class="built_in">Object</span>）太棒了。如果我们创造一门一切都是对象的语言会如何？
惰性求值（Lazy evaluation）太棒了。如果我们创造一门所有类型都是惰性的语言会如何？
</code></pre><p>极端主义编程（Extremist Programming, 与极限编程无关）是一种奉行某种思想（Principle），用它来衡量其他一切事物并将它应用在任何地方的行为。等到尘埃落定之后，人们通常会对着这种极端主义方式思考，“额，这确实很有趣，但是把X用在Y里明显不恰当。你需要换一种正确的方式来达到目的！”</p>
<p>上面这段话的意思是：有时候你需要使用错误的工具工作，因为你并不知道用这工具是不是正确的。如果你不到处使用函数，你也许就不明白将一个函数作为另一个函数的参数有怎样的功效，也许就不明白Cheap Lambda表达式的意义。如果你不到处使用对象，你也许就不理解其实整型和类的实例其实都是对象。如果你不到处使用惰性求值，你也许就没意识到其实函数的纯粹性（Purity）其实是一种更加重要的语言特征。</p>
<p>这就引出了两个建议：</p>
<ol>
<li><p>当学习一种新的思想时，尝试将它到处运用一番。这样你就可以很快的知道它什么时候适用什么时候不适用，即使你对它的第一印象全是错的。（另一方面，如果你没有进行这样错误的尝试的话，你将失去对它适用范围理解的机会。）</p>
</li>
<li><p>当试图理解某种思想的本质时，一个极端的例子是最清晰明了的。如果你想知道使用惰性求值编程是怎么样的，你会使用Haskell，而不是其他的非强制惰性求值的语言。即使这样极端的系统并不实用，但它确实能够更好的体现本质。</p>
</li>
</ol>
<p>极端主义在很多场合并不恰当，但是对于那些有趣的，小巧的项目或者研究，它真的能够教会你许多。给我印象最深的一件事情就是我去年和Adam Chlipala的合作。当时我们用Coq进行一些证明，我用的是中规中矩的方式，先一步一步推导要证的雏形，然后使用Ltac自动证明。Adam告诉我：“你应该一开始就自动证明的，不用麻烦的做手工推导”。真是醍醐灌顶：我就是不够极端！</p>
<pre><code>文件（<span class="keyword">File</span>）太棒了。如果我们创造一种一切都是文件的操作系统会如何？
<span class="keyword">Cons</span>结构（<span class="keyword">Cons</span> cell）太棒了。如果我们创造一种一切都由<span class="keyword">Cons</span>组成的编程语言会如何？
数学（Mathematics）太棒了。如果我们创造一种一切都是数学说了算的编程语言会如何？
数组（Array）太棒了。如果我们创造一种一切都是数组的语言会如何？
</code></pre><hr>
<p>翻译 by locatino<br>原文链接<a href="http://blog.ezyang.com/2012/11/extremist-programming/" target="_blank" rel="external">http://blog.ezyang.com/2012/11/extremist-programming/</a></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/06/29/一个通用的java程序控制脚本/">
                一个通用的Java程序控制脚本
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-06-29
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/Memo/">Memo</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>修改相应的参数就可以很方便的控制各类Java程序。<br>将脚本置于bin目录下，<br>推荐目录格式:<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#62; application&#10;&#9;&#62; bin&#10;&#9;&#62; lib&#10;&#9;&#62; log&#10;&#9;&#62; conf</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#! /bin/sh&#10;#-------------------------------------------------------------------&#10;# &#23450;&#20041;&#21464;&#37327;&#10;#-------------------------------------------------------------------&#10;&#10;libdir=../lib&#10;# &#27169;&#22359;&#21517;(&#31243;&#24207;&#30340;&#21807;&#19968;&#26631;&#35782;)&#10;MODEL_NAME=test&#10;# &#27169;&#22359;&#36816;&#34892;&#38656;&#35201;&#30340;lib&#10;MODEL_LIBS=`./stoc.sh $&#123;libdir&#125;`&#10;# &#36873;&#39033;(java&#21551;&#21160;&#21442;&#25968;)&#10;MODEL_OPTS=&#34;-Xmx128m -DConfig=../conf/db.xml -DtaskConfig=../conf/taskConfig.xml -Dlog4j.configuration=file:../conf/cmdcenter.log4j&#34;&#10;# &#36816;&#34892;&#31867;&#21517;(main&#20989;&#25968;&#25152;&#22312;&#31867;)&#10;MODEL_CLASS=&#34;com.locatino.server.TestServer&#34;&#10;# &#36816;&#34892;&#21442;&#25968;&#10;MODEL_VARS=&#34;0&#34;&#10;# &#21069;&#21488;/&#21518;&#21488;: 0-&#21069;&#21488;&#65292; 1-&#21518;&#21488;&#10;MODEL_DAEMON=1&#10;# &#26085;&#24535; &#39;&#38;-&#39;:&#34920;&#31034;&#20851;&#38381;&#26631;&#20934;&#36755;&#20986;&#26085;&#24535;&#10;MODEL_LOG=&#34;../log/error.log&#34;&#10;#-------------------------------------------------------------------&#10;# &#20197;&#19979;&#20869;&#23481;&#35831;&#19981;&#35201;&#20462;&#25913;&#10;#-------------------------------------------------------------------&#10;SLEEP_MIN=5&#10;# model info can be define here&#10;MODEL_SYMBOL=$&#123;MODEL_NAME&#125;&#10;GREP_KEY=&#34;Diname=&#34;$&#123;MODEL_SYMBOL&#125;&#10;# CLASSPATH can bu define here&#10;CLASSPATH=$&#123;MODEL_LIBS&#125;:.:$&#123;CLASSPATH&#125;&#10;#----------------------------------------------------------&#10;# function print usage&#10;#----------------------------------------------------------&#10;print_usage()&#10;&#123;&#10;echo &#34;&#34;&#10;echo &#34;\th|H|help|HELP             \tPrint help information.&#34;&#10;echo &#34;\tstart                     \tStart the $&#123;MODEL_NAME&#125; server.&#34;&#10;echo &#34;\tstop                      \tStop the $&#123;MODEL_NAME&#125; server.&#34;&#10;echo &#34;\tstatus                    \tStatus the $&#123;MODEL_NAME&#125; server.&#34;&#10;&#125;&#10;#-------------------------------------------------------------------&#10;# function model_is_exist&#10;#-------------------------------------------------------------------&#10;modelService_is_exist()&#10;&#123;&#10;localServerId=`ps -ef |grep &#34;$&#123;GREP_KEY&#125;&#34; | grep -v grep | awk &#39;&#123;print $2&#125;&#39;`&#10;if [ -z &#34;$&#123;localServerId&#125;&#34; ]&#10;then&#10;return 1&#10;else&#10;return 0&#10;fi&#10;&#125;&#10;#-------------------------------------------------------------------&#10;# function model_start&#10;#-------------------------------------------------------------------&#10;model_start ()&#10;&#123;&#10;modelService_is_exist&#10;if [ $? -eq &#34;0&#34; ]&#10;then&#10;        echo &#34;$&#123;MODEL_NAME&#125; is running yet. pid $&#123;localServerId&#125;.&#34;&#10;        return 0&#10;else&#10;        if [ $MODEL_DAEMON = 0 ]&#10;        then&#10;                echo &#34;try to start $&#123;MODEL_NAME&#125; ... foreground&#34;&#10;                $JAVA_HOME/bin/java -$&#123;GREP_KEY&#125; -classpath $&#123;CLASSPATH&#125; $&#123;MODEL_OPTS&#125; $&#123;MODEL_CLASS&#125; $&#123;MODEL_VARS&#125;&#10;        else&#10;                echo &#34;try to start $&#123;MODEL_NAME&#125; ... backgroud&#34;&#10;                nohup $JAVA_HOME/bin/java -$&#123;GREP_KEY&#125; $&#123;MODEL_OPTS&#125; -classpath $&#123;CLASSPATH&#125; $&#123;MODEL_CLASS&#125; $&#123;MODEL_VARS&#125; 1&#62;&#38;- 2&#62;&#62;$&#123;MODEL_LOG&#125; &#38;&#10;                sleep $SLEEP_MIN&#10;                modelService_is_exist&#10;                if [ $? -eq &#34;0&#34; ]&#10;                then&#10;                        echo &#34;$&#123;MODEL_NAME&#125; is running now. pid $&#123;localServerId&#125;.&#34;&#10;                        return 0&#10;                else&#10;                        echo &#34;failed to start $&#123;MODEL_NAME&#125;! see the output log for more details.&#34;&#10;                        return 1&#10;                fi&#10;        fi&#10;fi&#10;&#125;&#10;#-------------------------------------------------------------------&#10;# function model_stop&#10;#-------------------------------------------------------------------&#10;model_stop()&#10;&#123;&#10;echo &#34;try to stop $&#123;MODEL_NAME&#125; ...&#34;&#10;modelService_is_exist&#10;if [ $? -eq 0 ]&#10;then&#10;/usr/bin/kill $&#123;localServerId&#125;&#10;if [ $? -ne 0 ]&#10;then&#10;echo &#34;failed to stop $&#123;MODEL_NAME&#125;!&#34;&#10;return 1&#10;else&#10;echo &#34;$&#123;MODEL_NAME&#125; stopped.&#34;&#10;return 0&#10;fi&#10;else&#10;echo &#34;$&#123;MODEL_NAME&#125; is not running!&#34;&#10;return 1&#10;fi&#10;&#125;&#10;#-------------------------------------------------------------------&#10;# function model_status&#10;#-------------------------------------------------------------------&#10;model_status()&#10;&#123;&#10;modelService_is_exist&#10;if [ $? -eq 0 ]&#10;then&#10;echo &#34;$&#123;MODEL_NAME&#125; is running. pid $&#123;localServerId&#125;.&#34;&#10;else&#10;echo &#34;$&#123;MODEL_NAME&#125; is not running.&#34;&#10;fi&#10;&#125;&#10;#-------------------------------------------------------------------&#10;#&#10;#-------------------------------------------------------------------&#10;#-------------------------------------------------------------------&#10;# function parse_para&#10;#-------------------------------------------------------------------&#10;parse_para()&#10;&#123;&#10;case &#34;$1&#34; in&#10;start) model_start;;&#10;stop) model_stop;;&#10;status) model_status;;&#10;*) echo &#34;illage parameter : $1&#34;;print_usage;;&#10;esac&#10;&#125;&#10;#-------------------------------------------------------------------&#10;# main&#10;#-------------------------------------------------------------------&#10;parse_para $1</span><br></pre></td></tr></table></figure>
<p>下面是stoc.sh<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `find $1 -name &#34;*.jar&#34;` | sed -e &#39;s/ /:/g&#39;</span><br></pre></td></tr></table></figure></p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
      

  <div class="post post-type-normal ">
    <div class="post-header">

      
      
        <h1 class="post-title">
          
          
            
              <a class="post-title-link" href="/2015/06/29/第一篇/">
                Hello world
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          發表於 2015-06-29
        </span>

        
          <span class="post-category">
            &nbsp; | &nbsp; 分類於
            
              <a href="/categories/NONSENSE/">NONSENSE</a>

              
              

            
          </span>
        

        
          
        
      </div>
    </div>

    <div class="post-body">

      
      

      
        
          <p>这是<strong>新的开始</strong>，我用hexo创建了第一篇文章。</p>
<p>感觉非常好。</p>

        
      
    </div>

    <div class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </div>
  </div>


    
  </div>

  

        </div>

        
      </div>


      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <div class="site-overview">
        <div class="site-author motion-element">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="locatino" />
          <p class="site-author-name">locatino</p>
        </div>
        <p class="site-description motion-element">Can't take my eyes off you</p>
        <div class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">7</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">4</span>
              <span class="site-state-item-name">分類</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">9</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </div>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>
        
      </div>

      

    </div>
  </div>


    </div>

    <div id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; &nbsp; 
  2015
  <span class="with-love">
    <i class="icon-heart"></i>
  </span>
  <span class="author">locatino</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </div>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.3"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.3"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.3" id="motion.global"></script>



  <script type="text/javascript" src="/js/search-toggle.js"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
    });
  </script>

  

  
  
  

  




  
  

</body>
</html>
