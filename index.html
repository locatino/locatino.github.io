<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="LOCATINO&#39;S NOTE">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="LOCATINO&#39;S NOTE">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="Locatino">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-TW'
  };
</script>

  <title>LOCATINO'S NOTE</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">LOCATINO'S NOTE</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>關於</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/31/%E3%80%8A%E7%99%BD%E6%97%A5%E6%A2%A6%E6%83%B3%E5%AE%B6%E3%80%8B%EF%BC%9A%E5%B9%BB%E6%83%B3%E4%BA%BA%E7%94%9F%E7%9A%84%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/08/31/%E3%80%8A%E7%99%BD%E6%97%A5%E6%A2%A6%E6%83%B3%E5%AE%B6%E3%80%8B%EF%BC%9A%E5%B9%BB%E6%83%B3%E4%BA%BA%E7%94%9F%E7%9A%84%E8%A1%A5%E5%AE%8C%E8%AE%A1%E5%88%92/" class="post-title-link" itemprop="url">《白日梦想家》：幻想人生的补完计划</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>
              

              <time title="創建時間：2022-08-31 19:12:30 / 修改時間：20:17:40" itemprop="dateCreated datePublished" datetime="2022-08-31T19:12:30+08:00">2022-08-31</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NONSENSE/" itemprop="url" rel="index"><span itemprop="name">NONSENSE</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>不知道从什么时候开始，你开始兢兢业业地工作，你开始对每一件遗憾的事物释怀，你开始觉得现在的生活也还不错。<br>但是你就是不能满血，始终笼罩着一层无法驱散的惶惶不安，始终肩负着某些摆脱不了的沉重，好像总有一些不可知的事情会发生，没人给你兜底，也没有能够应对的踏实。虽然每天都能正常入眠，却不能真正休息，总有一些疲惫常驻后台。<br>不知道是从哪里开始出了问题，但你就是累了。<br>你开始想象平行世界的另一个你过着怎样的生活。</p>
<h3 id="What-is-LIFE"><a href="#What-is-LIFE" class="headerlink" title="What is LIFE ?"></a>What is LIFE ?</h3><p>影片中有一处男主在格陵兰岛租车时面临的选择：红色或者蓝色，明显是致敬《黑客帝国》中救世主尼奥对于红蓝药丸的选择。</p>
<p>当感觉生活甚至世界有些不对的时候，你面前有两个药丸，也就是两种选择，</p>
<p>红色告诉你所想要的真相但真相或许是你难以接受的，蓝色药丸吃下便忘记这一切第二天像往常一样起床但将永远不会接触到真相。</p>
<p>正如日常生活就像一个牢笼，困在里面也不自知，当然也不会想逃出来。</p>
<p>男主选择租下了红色的汽车，踏上旅程，告别了幻想，补完了自己的的灵魂。</p>
<p>我们每天重复着昨天的生活，随着惯性推进每一步，几乎丧失思考的空间和时间，人生匆匆忙忙，可是又毫无意义。</p>
<p>好像想要寻找什么打破这种真实到不真实的生活，急需一个突破口让某种能量冲出体内。</p>
<p>男主义无反顾地跳上了直升机，见过了格陵兰的鲨鱼、冰岛的火山、喜马拉雅的雪豹，</p>
<p>人生即是带着自己不甘堕落的心，去绽放不一样的生命之花。</p>
<p><strong>大多数人按照我们所安排的路线生活，害怕探索其它路线，但也会有一些人，他们并不满足于被设定的生活轨迹，冲破我们设置的重重阻碍，意识到自由意志是天赐之物的人，才明白只有在奋力抗争后才知道如何善用之。</strong></p>
<pre><code>To see the world, things dangerous to come to.
To see behind walls.
To draw closer.
To find each other and to feel.
That&#39;s the purpose of LIFE.
</code></pre>
<p><em>你是否也曾有那么恍惚一刻做着虚幻的白日梦想？</em></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/11/13/After-Hanabi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/13/After-Hanabi/" class="post-title-link" itemprop="url">After Hanabi</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-11-13 23:06:12" itemprop="dateCreated datePublished" datetime="2015-11-13T23:06:12+08:00">2015-11-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:12:46" itemprop="dateModified" datetime="2022-08-31T20:12:46+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NONSENSE/" itemprop="url" rel="index"><span itemprop="name">NONSENSE</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p style="text-align:center">Long long the stream that runs to sea
Listen to my plea
Listen willow and weep for me
<br>
Wisper to the wind and say that love has sinned
Left my heart a-breaking
</p>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/11/12/%E8%AF%AD%E9%9F%B3%E5%92%8C%E6%9C%BA%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/11/12/%E8%AF%AD%E9%9F%B3%E5%92%8C%E6%9C%BA%E5%99%A8/" class="post-title-link" itemprop="url">语音和机器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-11-12 11:06:12" itemprop="dateCreated datePublished" datetime="2015-11-12T11:06:12+08:00">2015-11-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:11:51" itemprop="dateModified" datetime="2022-08-31T20:11:51+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Translation/" itemprop="url" rel="index"><span itemprop="name">Translation</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>计算模型大致可以分为两类，λ演算和其他…好吧，也许Post的产生式系统和Herbrand-Goedel等式属于前者，但是毋庸置疑所有总所周知并且被广泛接受的模型比如图灵机，RAM和λ演算可不是一类的。Guy Blelloch将这类差异划分为语言和机器。基于机器的模型全部是在无界内存下的有限控制理论基础上讨论的。它依靠程序员去管理内存，实现一切结构，并且没有记号，没有解释器这样的机制在运行时改变程序；机器模型全部是非冯诺依曼机，因为它们没有存储程序的思想。基于语言的模型，相较之下，没有把程序和数据分开，并提供建立真实语言的基础，直接且没有编码。这似乎是一个λ演算的决定性优势：尽管机器模型出现在我们教材的前几章，但是他们本质上没有实际重要性，而λ演算对编程和逻辑系统的机械化来说是直接有用的。但现在机器模型仍然处于主宰地位，特别是算法和复杂度的领域，λ演算却作为冷门怪异的知识仅仅被计算机科学家的一小部分人研究。这是怎么回事？</p>
<p>遇到这个问题时，我的同事（至少在理论这边）认为这个问题一点意思都没有，回避了这个问题，因为“所有计算模型都需要多项式时间”，so who care? 好吧，如果你的工作在多项式因子的复杂度完成，并且你只关心对自然数（或者其他有限对象）的计算，那我猜这问题确实无所谓。你把某个问题算了一遍，对于那些利益相关的对象是如何在某个模型上表现的毫不关心，那细节的确无所谓。<br>但是明显地这些模型有所谓，事实上，说这话的同事在任何情况下都不会考虑经典的机器模型作为他工作的基础！毫无疑问，如果这些模型都是等价的话，选什么没关系，所以我们都可以选择λ演算，对吧？好吧，确实是这样。显而易见，有些模型是比其他模型更合适的！怎么会这样？</p>
<p>一个原因是许多工作并不是取决于多项式因子的（有人可能更认为，大部分都不是的）。所以对于这些目的，模型是有所谓的。另一方面，没有人在实际工作中用“正式的”模型。没人用图灵机码去描述算法，甚至RAM代码也没有用（Knuth是个例外）。反而，他们用的是类Algol语言，或者类C语言，或者类似的命令式编程符号。也就是说，他们用的是编程语言，而不是机器！他们当然这么做。但那又为什么强调机器模型呢？他们写的那些语言意味着什么？</p>
<p>答案是这些语言是由描述这样那样的类Algol语言如何对应于这样那样的RAM代码或者图灵机码的解释器定义的。这种表述虽不正式，但已足够准确使人明白。关键是，你推理的不是你写的代码，而是编译器写的代码，因为正式来讲目标代码才是“真正的”代码，伪代码只是提供一个方便。所以在工作中，你脑子里必须有一个编译器：它对一切你写的代码都清楚明白，知道如何翻译成，比如RAM代码。这并不是太难，因为伪代码简单，简单到你可以直接在脑子里编译它。这种方式不错，但是会逐渐出现问题，因为它约束了我们表达算法的语言从而限制了我们能够方便表达和分析的算法的范围。</p>
<p>那为什么坚持使用这样麻烦的方式呢？一个原因是，传统。我的导师用它，所以我也用它。或者，如果你想要发论文，你最好用一种评审熟悉的风格写。<br>一个更实际的原因是，机器模型是描述计算开销的基础。计算的一“步”就是机器的一步，我们通过估算解决同一问题算法的步数来比较算法（取决于乘法因子，大部分情况下）。只要我们能够“手工编译”类Algol语言到机器码，我们就可以给一个比汇编语言高级的语言赋一个开销，还可以对各类算法做合理的比较。这种方法良好的满足了我们的需求，但是现在它开始没那么管用了（并行是一个原因，但还有许多其他理由）。</p>
<p>有一个替代选项，为我们书写的语言提供了开销语义，并且直接地在这个基础上开展我们的分析，不用迎合编译器或者依赖机器。简而言之我们采用了计算的语言模型，而非机器模型，生活更美好！表达算法有更多的方式，还简化了分析算法的方法。</p>
<p>要用这种方式我们需要我们使用的语言一个开销语义。这也就是λ演算的优势，因为它是描述计算的语言模型的典型例子。简单来说，λ演算的右箭头标记表示一步推导，写作M→M’，表示M程序经过一步计算之后的结果为M’程序。执行过程直接由我们写出，并且模型还为计算步骤提供了良定义的标记，我们可以数出来获取程序的时间复杂度。数十年的经验表明这种方法扩展到了真实语言。</p>
<p>有什么缺点呢？我个人找不出什么缺点。我一直很困惑，觉得λ演算应该在算法圈子里被接受。正如任何机器模型都被当做完美的计算基础，而业界的行为都显明机器模型对实际完成的工作有很大的限制！<br>唯一的原因我觉得，除去强大的社会影响，就是停滞不前，还未发现λ演算里关于开销的概念对算法分析的适合。（一个研究员最近告诉我“你可以塞一头大象在β推导里！”，然而他还是没法解释我哪错了。）一种验证这个观点的方法就是，定义出一个λ演算到RAM代码的编译器，确保λ演算里的抽象步骤能被RAM在常量时间里实现（不考虑输入大小，只考虑静态程序的大小）。Blelloch和Greiner在90年代初已经精确的完成了这项分析。详见<a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/~guyb/">Guy’s web page</a>。</p>
<p>之后的博文里我会深入的考察这些思想，并且表明（通过检查Blelloch的工作）λ演算不仅可以作为一个串行算法的良好模型，对并行算法也是一样！而且我们可以轻松地把模型扩展为具有重要抽象能力的语言比如高阶函数或者不用优化就能表达和分析算法。</p>
<hr>
<p>翻译 by locatino<br><a target="_blank" rel="noopener" href="https://existentialtype.wordpress.com/2011/03/16/languages-and-machines/">原文</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/21/Stack-Overflow%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E9%80%89%E8%AE%B2-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/21/Stack-Overflow%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E9%80%89%E8%AE%B2-1/" class="post-title-link" itemprop="url">Stack Overflow经典问题选讲(1)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-09-21 11:06:12" itemprop="dateCreated datePublished" datetime="2015-09-21T11:06:12+08:00">2015-09-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:13:08" itemprop="dateModified" datetime="2022-08-31T20:13:08+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MEMO/" itemprop="url" rel="index"><span itemprop="name">MEMO</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>##Question##<br>下面是一段非常神奇的**C++**代码。因为一些莫名其妙的原因，处理排序后的数据比没有排序的数据奇迹般的快了许多倍。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Generate data</span></span><br><span class="line"><span class="type">const</span> <span class="type">unsigned</span> arraySize = <span class="number">32768</span>;</span><br><span class="line"><span class="type">int</span> data[arraySize];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> c = <span class="number">0</span>; c &lt; arraySize; ++c)</span><br><span class="line">data[c] = <span class="built_in">std</span>::rand() % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// !!! With this, the next loop runs faster</span></span><br><span class="line"><span class="built_in">std</span>::sort(data, data + arraySize);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test</span></span><br><span class="line"><span class="type">clock_t</span> start = clock();</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> i = <span class="number">0</span>; i &lt; <span class="number">100000</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Primary loop</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">unsigned</span> c = <span class="number">0</span>; c &lt; arraySize; ++c)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (data[c] &gt;= <span class="number">128</span>)</span><br><span class="line">sum += data[c];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> elapsedTime = static_cast&lt;<span class="type">double</span>&gt;(clock() - start) / CLOCKS_PER_SEC;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; elapsedTime &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sum = &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>没有<code>std::sort(data, data + arraySize);</code>这句代码，程序运行了<strong>11.54</strong>秒。</li>
<li>有上述那句代码，程序运行了<strong>1.93</strong>秒。</li>
</ul>
<p>最开始，我以为这只是特定语言或者编译器的反常现象。所以我在<strong>Java</strong>里也试了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Generate data</span></span><br><span class="line"><span class="type">int</span> <span class="variable">arraySize</span> <span class="operator">=</span> <span class="number">32768</span>;</span><br><span class="line"><span class="type">int</span> data[] = <span class="keyword">new</span> <span class="title class_">int</span>[arraySize];</span><br><span class="line"></span><br><span class="line"><span class="type">Random</span> <span class="variable">rnd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; arraySize; ++c)</span><br><span class="line">data[c] = rnd.nextInt() % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// !!! With this, the next loop runs faster</span></span><br><span class="line">Arrays.sort(data);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Test</span></span><br><span class="line"><span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"><span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100000</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Primary loop</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; arraySize; ++c)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (data[c] &gt;= <span class="number">128</span>)</span><br><span class="line">sum += data[c];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println((System.nanoTime() - start) / <span class="number">1000000000.0</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;sum = &quot;</span> + sum);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果也类似，只不过速度差异没有那么夸张。<br>我最初以为是因为排序把数据带入了高速缓存里，但马上就发现这个想法多么愚蠢，因为数组是运行时生成的。</p>
<ul>
<li>发生了什么事？</li>
<li>为什么排序后的数组比没有排序的数组处理起来快？</li>
<li>代码仅仅把数据元素单独的相加，数据元的顺序应该没有影响才对。</li>
</ul>
<hr>
<br>
##Answer##
你是[分支预测](https://en.wikipedia.org/wiki/Branch_predictor)(branch prediction)失败的受害者。

<hr>
<p>##什么是分支预测？##<br>请参考下图铁轨分岔路：<br><img src="http://i.stack.imgur.com/muxnt.jpg" alt="train_pic"><br>为了方便说明这个程序问题，假设我们回到了1800年代——在无线电或者其他长距离通信方式发明之前。<br>你是一名操作员，你听到了一辆火车正在驶来。你不知道它要走哪个方向。你停下了火车去问列车长他要走哪个方向。然后你正确地设置了分岔口的开关。<br><br><br><em>火车重，并且惯性大。所以它们启动和停下需要花费大量的时间。</em><br><br><br>那有没有更好的方式？你来猜火车会走哪条路！</p>
<ul>
<li>如果你猜对了，火车就继续走。</li>
<li>如果你猜错了，那列车长会停车，退回，训斥你重新操作分岔开关。然后火车重新驶向另一条路。</li>
</ul>
<p><strong>如果你每次都猜对，</strong>火车将永远不用停下来。</p>
<p><strong>如果你老是猜错，</strong>火车将会花费大量的时间停下来，退回，重启。</p>
<hr>
<p><strong>观察下列if语句：</strong>在处理器层面上，它是一条分支指令：<br><img src="http://i.stack.imgur.com/pyfwC.png" alt="branch_instruction"><br>假设你是一个处理器并且你发现了一个分支指令。你不知道接下来会执行哪条指令。你怎么办？你挂起了程序，等待之前的指令执行完毕。然后你顺着正确的分支继续执行。<br><br><br><em>现代处理器结构复杂并且拥有长流水线。所以它们启动和停止需要花费大量的时间。</em><br><br><br>那有没有更好的方式？你来猜接下来会执行哪条分支！</p>
<ul>
<li>如果你猜对了，你就继续执行。</li>
<li>如果你猜错了，你需要刷新指令流水线并回退到分支语句。然后你重新执行正确地分支。</li>
</ul>
<p><strong>如果你每次都猜对，</strong>执行将永远不用停止。<br><strong>如果你老是猜错，</strong>你将花费大量的时间停止，回退，重启。</p>
<hr>
<p>这就是分支预测。我承认上面的比喻不是最合适的，因为火车只需要打一面标识行进方向的旗子就可以了。但是计算机里，处理器不到最后一刻是不会知道该进入哪条分支的。<br>所以你该如何选择猜测方案来最小化火车回退重启的次数呢？你观察之前的历史！如果火车99%的情况下走左边，那么你就猜左。反之，你就猜右。如果它每三次就走其中某个特定的方向，你就猜它接下来也是这样……<br><strong>换句话说，你试图找出一个模式并遵循它。</strong>这差不多就是分支预测器的工作方式。<br>大部分应用都有可良好预测的分支。所以现代分支预测器差不多可以达到&gt;90%的命中率。但是当面临无可预测的分支并且毫无规律可循的情况下，分支预测器基本上形同虚设。</p>
<p>深入阅读：<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Branch_predictor">“Branch predictor” article on Wikipedia</a>。</p>
<hr>
<p>##根据以上所说，罪魁祸首就是这条if语句##</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data[c] &gt;= <span class="number">128</span>)</span><br><span class="line">sum += data[c];</span><br></pre></td></tr></table></figure>
<p>注意到数据是均匀的分布在0到255之间。所以当数据从小到大排序之后，差不多前部分有一半的数据没有进入if语句的分支里。之后，剩下的数据全部进入if语句的分支里。<br>这对分支预测器是十分友好的，因为程序会连续的进入同一分支多次。一个简单的饱和计数器都可以正确的预测分支，除了刚好程序转向时的那几次失败。<br>###简单视图化###</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">T = branch taken</span><br><span class="line">N = branch not taken</span><br><span class="line"></span><br><span class="line">data[] = 0, 1, 2, 3, 4, ... 126, 127, 128, 129, 130, ... 250, 251, 252, ...</span><br><span class="line">branch = N N N N N ... N N T T T ... T T T ...</span><br><span class="line"></span><br><span class="line">= NNNNNNNNNNNN ... NNNNNNNTTTTTTTTT ... TTTTTTTTTT (easy to predict)</span><br></pre></td></tr></table></figure>
<p>然而，当数据完全随机，分支预测器毫无用处因为它无法预测随机数据。因此，大概有50%的错误预测。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data[] = 226, 185, 125, 158, 198, 144, 217, 79, 202, 118, 14, 150, 177, 182, 133, ...</span><br><span class="line">branch = T, T, N, T, T, T, T, N, T, N, N, T, T, T, N ...</span><br><span class="line"></span><br><span class="line">= TTNTTTTNTNNTTTN ... (completely random - hard to predict)</span><br></pre></td></tr></table></figure>

<hr>
<p>###所以应该如何是好？###<br>如果编译器没法把分支优化成可良好预测，你可以用一些技巧优化，如果你愿意为性能牺牲可读性的话。<br>将：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data[c] &gt;= <span class="number">128</span>)</span><br><span class="line">sum += data[c];</span><br></pre></td></tr></table></figure>
<p>替换为：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> t = (data[c] - <span class="number">128</span>) &gt;&gt; <span class="number">31</span>;</span><br><span class="line">sum += ~t &amp; data[c];</span><br></pre></td></tr></table></figure>
<p>这样就用一些位操作消除了分支。（上述方法并不等价于原来的if语句。仅仅是在这个例子中跟原来的if语句效果一样。）</p>
<p>###测试环境：Core i7 920 @ 3.5 GHz###<br><code>C++ - Visual Studio 2010 - x64 Release</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// Branch - Random</span><br><span class="line">seconds = 11.777</span><br><span class="line"></span><br><span class="line">// Branch - Sorted</span><br><span class="line">seconds = 2.352</span><br><span class="line"></span><br><span class="line">// Branchless - Random</span><br><span class="line">seconds = 2.564</span><br><span class="line"></span><br><span class="line">// Branchless - Sorted</span><br><span class="line">seconds = 2.587</span><br></pre></td></tr></table></figure>
<p><code>Java - Netbeans 7.1.1 JDK 7 - x64</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// Branch - Random</span><br><span class="line">seconds = 10.93293813</span><br><span class="line"></span><br><span class="line">// Branch - Sorted</span><br><span class="line">seconds = 5.643797077</span><br><span class="line"></span><br><span class="line">// Branchless - Random</span><br><span class="line">seconds = 3.113581453</span><br><span class="line"></span><br><span class="line">// Branchless - Sorted</span><br><span class="line">seconds = 3.186068823</span><br></pre></td></tr></table></figure>
<p>观测结果：</p>
<ul>
<li>使用分支语句：排序和未排序的数据处理效率差异巨大。</li>
<li>消除分支语句：排序和未排序的数据没有区别。</li>
<li>使用C++时，消除分支语句的执行速度是比使用分支处理排序后的数据的速度慢一点的。</li>
</ul>
<p>所以一般的最佳做法是避免在重要的循环中使用依赖数据特性的分支。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/09/16/%E5%85%B3%E4%BA%8E%E3%80%8A%E7%90%86%E6%83%B3%E5%9B%BD%E3%80%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/09/16/%E5%85%B3%E4%BA%8E%E3%80%8A%E7%90%86%E6%83%B3%E5%9B%BD%E3%80%8B/" class="post-title-link" itemprop="url">关于《理想国》</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-09-16 10:27:18" itemprop="dateCreated datePublished" datetime="2015-09-16T10:27:18+08:00">2015-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:09:28" itemprop="dateModified" datetime="2022-08-31T20:09:28+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Philosophy/" itemprop="url" rel="index"><span itemprop="name">Philosophy</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>整个西方哲学只不过是一连串柏拉图的注脚而已。<br><br><br>人的认知状态分成不同等级：从最低级的想像，到信念，再到思想，最高的认知是理解。<br><br><br>洞穴假说：每一次上升，每一次转向光，他都会眼睛痛，恨不得返回从前的状态。但一旦他习惯于新的明亮世界，他会为自己脱离以前的黑暗愚昧状态而庆幸，并可怜仍然生活在那里的同伴。<br><br><br>有多少人反思过自己的伦理道德标准的有效性和有限性。<br><br><br>所谓“解救”，是让人把头转过去，将灵魂进行转向。转了向，就看到了火。而这其实就是使灵魂得到了光明。我们经常讲的“启蒙”一次就是enlightment，字面意义是“在灵魂中(en)有了光(light)”。<br><br><br>把哲学分门别类是柏拉图的学生亚里士多德的事。<br><br><br>四大主德：正义，勇敢，节制，智慧。<br><br><br>一种观点可能被驳倒，但这不等于说这种观点一定是错的。<br><br><br>按照苏格拉底的观点，任何惩罚，应当是教育性的。唯有当某种惩罚是为了改进某个人的灵魂，才有正当性。<br><br><br>人们称颂正义，并不是因为他们认为正义好于不正义，而是因为他们乐于别人对他们正义。<br><br><br>正确的理解是，正义或道德自身就是幸福的内在构成部分，幸福不是正义的处在目的，而是依附于正义的。<br><br><br>苏格拉底，柏拉图，亚里士多德都是反民主的。在某种程度上是现代民主制的敌人。<br><br><br>有些人在理想城邦中的地位较低，由此会心生不满。但这只是因为他们不明白，他们的地位其实是他们自然地应当占有的位置。真理只能为社会中的一小部分人发现并掌握。社会中的大部分人都生活在洞穴之中，没有办法自己发现真理。<br><br><br>在柏拉图看来，底阶层受到一点欺骗却可以按自然而生活，这应是值得的。<br><br><br>凡是人类拥有的恶，奥林匹斯山上的诸神无不具有。<br><br><br>人类有一种惰性，即灵魂很容易被同化为我们所看到，所听到的东西。<br><br><br>悲剧是危险的，它破坏了对有关道德问题寻求单一理性答案的努力。<br><br><br>专制主义也有比较温和的形式。那就是，个人是整体的成员，但国家的功能与目的只是要促进公民的福祉，国家并无除此而外的独立利益。这种温和的形式也可叫做权威主义或家长制。<br><br><br>柏拉图确定了灵魂的三个部分：欲望，理性和激情。<br><br><br>所谓的意志薄弱现象的出现并不是因为人们对快乐的欲求战胜了人们对好或善的欲求，而是因为人类根本不知道什么是好，没有关于好的真正的知识。<br><br><br>所以，当人们以为出现意志薄弱的情况时，其实所犯的真正错误是无知。<br><br><br>对“什么是x”这类问题的回答应当找到一个形式(eidos)F。它呈现在一切被称为F的事物中，是所有F事物都共有的F这一属性。因为它，F的事物才成为F。一个适当的定义必须找到这样的形式。这一定义不是说明该术语的日常用法，而是要揭示该术语所代表的客观的共同本质。<br><br><br>总之，知道某个事物是否具有某种属性并不是古代哲人所关心的事情。他们所关注的是不希望看到人们处于混乱，困惑的状态，而要让人们能够去除无知，并且自我意识到自己处于明白的状态。<br><br><br>历史上的苏格拉底亦有名言曰，光喝水不喝酒是产生不了智慧的。<br><br><br>真正的哲学家是没有统治欲望的。<br><br><br>“善自身在理智领域中与理智和可知事物的关系，就如同太阳在可见世界中视力和可见事物的关系一样”。理智把握可知事物即形式，得到知识，就正如视力在可见世界中观看可感事物而得到感觉一样。<br><br><br>形式是用来说明具体事物的“是”或存在(being)的；而善的形式则是用来说明形式的“是”或存在。<br><br><br>在柏拉图看来不懂数学是无法超越可感世界而进入可知世界的。<br><br><br>如果说一个人能够思想了，或开始思想了，那就是说他或她能够解脱习俗樊篱的束缚，破除对日常经验的顺随，而开始对其自身所处的世界进行批判性的思考。<br><br><br>教育在柏拉图那里不是对知识和信息的获得，不是把知识放进灵魂。教育是让灵魂转向其应该关注的对象和方向上去，让它能使用自身的能力去看。<br><br><br>数与计算是为一切思想，一切技艺所共同使用的东西。<br><br><br>数学自然能够将人从可感事物上升到形式。<br><br></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/06/Alice-Where-Art-Thou/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/08/06/Alice-Where-Art-Thou/" class="post-title-link" itemprop="url">Alice, Where Art Thou?</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-08-06 10:27:18" itemprop="dateCreated datePublished" datetime="2015-08-06T10:27:18+08:00">2015-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:11:24" itemprop="dateModified" datetime="2022-08-31T20:11:24+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NONSENSE/" itemprop="url" rel="index"><span itemprop="name">NONSENSE</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p style="text-align:center">Quaint child, old-fashioned Alice, lend your dream:
I would be done with modern story-spinners,
Follow with you the laughter and the gleam:
Weary I am, this night, of saints and sinners.
We have been friends since Lewis and old Tenniel
Housed you immortally in red and gold.
Come! Your naivete is a spring perennial:
Let me be young again before I am old.
<br>
You are a glass of youth: this night I choose
Deep in your magic labyrinths to stray,
Where rants the Red Queen in her splendid hues
And the Write Rabbit hurries on his way.
Let us once more adventure, hand in hand:
Give me belief again—— in Wonderland!
</p>

<p style="text-align:right">——Vincent Starret, in <I>Brillig</I></p>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/08/03/%E7%8E%A9%E8%BD%ACPython-Lambda/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/08/03/%E7%8E%A9%E8%BD%ACPython-Lambda/" class="post-title-link" itemprop="url">玩转Python Lambda</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-08-03 16:28:01" itemprop="dateCreated datePublished" datetime="2015-08-03T16:28:01+08:00">2015-08-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:12:18" itemprop="dateModified" datetime="2022-08-31T20:12:18+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Memo/" itemprop="url" rel="index"><span itemprop="name">Memo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近在学习函数式编程，又想顺便学下大名鼎鼎的<strong>Python</strong> ，遂把<strong>The little schemer</strong>里的<strong>scheme</strong>代码全部用<strong>Python</strong>实现了一遍。<br>函数式编程的精髓当然是传说中的<strong>lambda</strong>表达式，本来打算用<strong>Python lambda</strong>实现<strong>scheme</strong>代码，没想到网上一查<strong>API</strong>，却发现<strong>Python lambda</strong>实在是做的弱到不行……不能缩进（一个<strong>lambda</strong>函数只能写在一行），只能用<strong>if…else…</strong>，只能写一条语句等等。</p>
<blockquote>
<p>“Why can’t lambda expressions contain statements?</p>
</blockquote>
<blockquote>
<p>Python lambda expressions cannot contain statements because Python’s syntactic framework can’t handle statements nested inside expressions. However, in Python, this is not a serious problem. Unlike lambda forms in other languages, where they add functionality, Python lambdas are only a shorthand notation if you’re too lazy to define a function.</p>
</blockquote>
<blockquote>
<p>Functions are already first class objects in Python, and can be declared in a local scope. Therefore the only advantage of using a lambda instead of a locally-defined function is that you don’t need to invent a name for the function – but that’s just a local variable to which the function object (which is exactly the same type of object that a lambda expression yields) is assigned!”</p>
</blockquote>
<p>为啥<strong>lambda</strong>表达式不能包含语句？</p>
<p>以上是<strong>Python</strong>官方<strong>FAQ</strong>给出的答复：<strong>lambda</strong>表达式就是给你偷懒少打几个字用的，不支持在语句中嵌套表达式。</p>
<p>基本上<strong>Python Lambda</strong>就应用在以下场景：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">f = lambda x, y: x + y</span><br><span class="line">g = lambda x: x + 1</span><br><span class="line"></span><br><span class="line">print(f(1, 2))</span><br><span class="line">print(g(1))</span><br></pre></td></tr></table></figure>
<p>这匿名函数还tm有个名字。<br>或者你可以节约名字:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print((lambda x, y: x + y)(1, 2))</span><br><span class="line">print((lambda x: x + 1)(1))</span><br></pre></td></tr></table></figure>
<p>是不是觉得还不如这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(1 + 2)</span><br><span class="line">print(1 + 1)</span><br></pre></td></tr></table></figure>
<p>不得不说<strong>Python lambda</strong>简直是鸡肋。</p>
<p>但是，你注意到<strong>Python lambda</strong>支持<strong>if…else…</strong>语句了吗，<strong>scheme</strong>也只有<strong>cond…else</strong>这一种控制语句，却是非常优美的函数式<strong>PL</strong>。<br>所以我试着用<strong>if…else…</strong>来搞点名堂。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x: True if x % 2 == 0 else False</span><br></pre></td></tr></table></figure>
<p>上面的函数判断一个数是不是偶数，其中<strong>if…else…</strong>是<strong>Python lambda</strong>的标准用法。<br>冒号后面接返回值<strong>return-expression</strong>，接着是该返回值的条件<strong>cond-expression</strong>，接着<strong>else</strong>，然后是<strong>else</strong>的返回值。<br><strong>Python lambda</strong>总共以下2种写法，一种是不含<strong>if…else…</strong>的，一种是包含<strong>if…else…</strong>的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;args&gt;: &lt;return-expression&gt;</span><br><span class="line">lambda &lt;args&gt;: &lt;return-expression&gt; if &lt;cond-expression&gt; else &lt;return-expression&gt;</span><br></pre></td></tr></table></figure>
<p>第二条语句的**”&lt; return-expression &gt; if &lt; cond-expression &gt; else &lt; return-expression &gt;”** 整体也是一个<strong>return-expression</strong>。<br>所以我们可以在<strong>else</strong>后的<strong>return-expression</strong>中嵌套<strong>return-expression</strong>来完成复杂的条件判断语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;args&gt;: &lt;return-expression&gt; if &lt;cond-expression&gt; else (&lt;return-expression&gt; if &lt;cond-expression&gt; else &lt;return-expression&gt;)</span><br></pre></td></tr></table></figure>
<p>如果想要在匿名函数中做一些除了<strong>return-expression</strong>，其他事情（比如说<strong>print()<strong>）,应该怎么写？<br>确实不太好写，不过我还是想出了一个非常</strong>投机取巧</strong>的办法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x: True if x % 2 == 0 and print(x) == None else x&quot;)</span><br></pre></td></tr></table></figure>
<p>上面这个函数不仅返回了<strong>x</strong>的值，并且还打印了<strong>x</strong>，这里我把需要执行的语句(<strong>print()</strong>)转换成了逻辑表达式，而且是一个永远为真的表达式，它一定会执行，并且对业务的逻辑判断没有影响。<br>前提是你必须准确的知道需要执行的语句的返回值，才能写出永远为真的表达式。再写一个例子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x, l: l if l.insert(0,x) == None else l</span><br></pre></td></tr></table></figure>
<p>上面这个函数把元素<strong>x</strong>插入到<strong>l</strong>的头部，并返回<strong>l</strong>。<br>通过这种<strong>投机取巧</strong>的办法我们可以大大扩充<strong>Python lambda</strong>的功能。</p>
<p><strong>Python lambda</strong>还可以返回异常：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda x: TypeError(&quot;x is zero.&quot;) if x == 0 else 5/x</span><br></pre></td></tr></table></figure>

<p>那么迭代（循环）怎么写？<br>迭代确实是一个难题，<strong>scheme</strong>这样没有迭代的语句是怎么实现迭代的？递归。<br>首先我们先用常规函数的递归实现迭代：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#求和递归版本</span><br><span class="line">def sum_recur(l):</span><br><span class="line">if len(l) == 0:</span><br><span class="line">return 0</span><br><span class="line">else:</span><br><span class="line">return l[0] + sum_recur(l[1:])</span><br><span class="line"></span><br><span class="line">#求和迭代版本</span><br><span class="line">def sum_iter(l):</span><br><span class="line">sum = 0</span><br><span class="line">for i in l:</span><br><span class="line">sum += i</span><br><span class="line">return sum</span><br></pre></td></tr></table></figure>
<p>以上2个函数均实现了<strong>list l</strong>中元素求和，功能上是等价的。</p>
<p>但是匿名函数要递归调用自身难度很高。<br>以下可能有点高能，初学者慎入。<br>首先要知道，<strong>lambda</strong>表达式也是一个<strong>return-expression</strong>。所以我们还可以在<strong>lambda</strong>中返回<strong>lambda</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lambda &lt;args&gt;: lambda &lt;args&gt;: &lt;return-expression&gt;</span><br></pre></td></tr></table></figure>
<p>先看看下面这个函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def sum(f):</span><br><span class="line">return lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:])</span><br><span class="line"></span><br><span class="line">print(sum(sum)([1,2]))</span><br></pre></td></tr></table></figure>
<p>这个函数接受一个自身作为参数，返回值是一个求和函数，也就是实际的递归本体，即<strong>sum(sum) &#x3D; lambda l:0 if len(l) &#x3D;&#x3D; 0 else l[0] + sum(sum)(l[1:])</strong>,如此实现递归调用自身。<br>我们先把<strong>sum(f)<strong>转换成</strong>lambda</strong>函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def sum(f):</span><br><span class="line">return lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:])</span><br><span class="line"></span><br><span class="line">lambda f: lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:])</span><br></pre></td></tr></table></figure>
<p>上述2个函数式功能是等价的,返回值都相同，只是一个有名字而已，匿名函数没有名字如何调用自身？也是通过函数的参数，并且直接使用自身的定义，所以我们可以令**sum(sum)**为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sum(lambda f: lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:]))</span><br><span class="line">#第二个sum，也就是作为参数的sum已被等价的lambda替换，</span><br><span class="line">#现在我们再来替换第一个sum</span><br><span class="line">(lambda f: lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:])) (lambda f: lambda l:0 if len(l) == 0 else l[0] + f(f)(l[1:]))</span><br></pre></td></tr></table></figure>
<p>这就完成了匿名函数递归调用自身。测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">g = (lambda f: lambda l: 0 if len(l) == 0 else l[0] + f(f)(l[1:])) (lambda f: lambda l: 0 if len(l) == 0 else l[0] + f(f)(l[1:]))</span><br><span class="line"></span><br><span class="line">print(g([1,2,3]))</span><br></pre></td></tr></table></figure>
<p>接下来优化一下~</p>
<p>注意到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#f(f)(x)</span><br><span class="line">#等价于</span><br><span class="line">#lambda x: f(f)(x)</span><br><span class="line"></span><br><span class="line">#那么我们可以把上面出现的f(f)都用参数替换，然后传一个lambda x: f(f)(x)作为参数即可</span><br><span class="line">g = (lambda f: lambda l: 0 if len(l) == 0 else l[0] + (lambda x: f(f)(x))(l[1:])) (lambda f: lambda l: 0 if len(l) == 0 else l[0] + (lambda x: f(f)(x))(l[1:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = (lambda y: (lambda f:lambda l: 0 if len(l) == 0 else l[0] + f(l[1:]))(lambda x: y(y)(x)))(lambda y: (lambda f:lambda l: 0 if len(l) == 0 else l[0] + f(l[1:]))(lambda x: y(y)(x)))</span><br><span class="line">#注意：</span><br><span class="line">lambda f:lambda l: 0 if len(l) == 0 else l[0] + f(l[1:])</span><br><span class="line">#此函数就是真正的业务递归过程，其他结构均是辅助，我们可以提取出来</span><br><span class="line">job = lambda f:lambda l: 0 if len(l) == 0 else l[0] + f(l[1:])</span><br><span class="line"></span><br><span class="line">g = (lambda y: job(lambda x: y(y)(x)))(lambda y: job(lambda x: y(y)(x)))</span><br><span class="line"></span><br><span class="line">print(g([1,2,3]))</span><br></pre></td></tr></table></figure>
<p>这个<strong>g</strong>就是传说中的上古神器<strong>Y-Combinator</strong>！它就是一个通用的匿名函数递归公式。</p>
<p>至此，我们已经把<strong>Python lambda</strong>的功能扩充的基本和普通函数差不多了（额，可能还差一点）。<br>而且所有函数全部一行完成，然而并没有什么卵用。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/07/06/The-Little-Book-of-Semaphores/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/07/06/The-Little-Book-of-Semaphores/" class="post-title-link" itemprop="url">The Little Book of Semaphores</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-07-06 10:41:37" itemprop="dateCreated datePublished" datetime="2015-07-06T10:41:37+08:00">2015-07-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:13:39" itemprop="dateModified" datetime="2022-08-31T20:13:39+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Books/" itemprop="url" rel="index"><span itemprop="name">Books</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://github.com/locatino/locatino.github.io/raw/master/images/book-the-little-book-of-semaphores.jpg"><br>本书教授了如何理解多线程执行和如何解决同步问题。尤其推荐给自学和初学者。<br>里面一步步教导读者解决一系列的经典和不那么经典的同步问题。内容非常有趣。<br>下载链接：<a target="_blank" rel="noopener" href="http://www.greenteapress.com/semaphores/downey08semaphores.pdf">http://www.greenteapress.com/semaphores/downey08semaphores.pdf</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/07/01/%E6%9E%81%E7%AB%AF%E7%BC%96%E7%A8%8B%E4%B8%BB%E4%B9%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/07/01/%E6%9E%81%E7%AB%AF%E7%BC%96%E7%A8%8B%E4%B8%BB%E4%B9%89/" class="post-title-link" itemprop="url">极端编程主义</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-07-01 09:23:58" itemprop="dateCreated datePublished" datetime="2015-07-01T09:23:58+08:00">2015-07-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:10:28" itemprop="dateModified" datetime="2022-08-31T20:10:28+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Translation/" itemprop="url" rel="index"><span itemprop="name">Translation</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>函数（Function）太棒了。如果我们创造一门只有函数的语言会如何？<br>对象（Object）太棒了。如果我们创造一门一切都是对象的语言会如何？<br>惰性求值（Lazy evaluation）太棒了。如果我们创造一门所有类型都是惰性的语言会如何？</p>
<p>极端主义编程（Extremist Programming, 与极限编程无关）是一种奉行某种思想（Principle），用它来衡量其他一切事物并将它应用在任何地方的行为。等到尘埃落定之后，人们通常会对着这种极端主义方式思考，“额，这确实很有趣，但是把X用在Y里明显不恰当。你需要换一种正确的方式来达到目的！”</p>
<p>上面这段话的意思是：有时候你需要使用错误的工具工作，因为你并不知道用这工具是不是正确的。如果你不到处使用函数，你也许就不明白将一个函数作为另一个函数的参数有怎样的功效，也许就不明白Cheap Lambda表达式的意义。如果你不到处使用对象，你也许就不理解其实整型和类的实例其实都是对象。如果你不到处使用惰性求值，你也许就没意识到其实函数的纯粹性（Purity）其实是一种更加重要的语言特征。</p>
<p>这就引出了两个建议：</p>
<ol>
<li><p>当学习一种新的思想时，尝试将它到处运用一番。这样你就可以很快的知道它什么时候适用什么时候不适用，即使你对它的第一印象全是错的。（另一方面，如果你没有进行这样错误的尝试的话，你将失去对它适用范围理解的机会。）</p>
</li>
<li><p>当试图理解某种思想的本质时，一个极端的例子是最清晰明了的。如果你想知道使用惰性求值编程是怎么样的，你会使用Haskell，而不是其他的非强制惰性求值的语言。即使这样极端的系统并不实用，但它确实能够更好的体现本质。</p>
</li>
</ol>
<p>极端主义在很多场合并不恰当，但是对于那些有趣的，小巧的项目或者研究，它真的能够教会你许多。给我印象最深的一件事情就是我去年和Adam Chlipala的合作。当时我们用Coq进行一些证明，我用的是中规中矩的方式，先一步一步推导要证的雏形，然后使用Ltac自动证明。Adam告诉我：“你应该一开始就自动证明的，不用麻烦的做手工推导”。真是醍醐灌顶：我就是不够极端！</p>
<p>文件（File）太棒了。如果我们创造一种一切都是文件的操作系统会如何？<br>Cons结构（Cons cell）太棒了。如果我们创造一种一切都由Cons组成的编程语言会如何？<br>数学（Mathematics）太棒了。如果我们创造一种一切都是数学说了算的编程语言会如何？<br>数组（Array）太棒了。如果我们创造一种一切都是数组的语言会如何？</p>
<hr>
<p>翻译 by locatino<br>原文链接<a target="_blank" rel="noopener" href="http://blog.ezyang.com/2012/11/extremist-programming/">http://blog.ezyang.com/2012/11/extremist-programming/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="http://example.com/2015/06/29/%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E7%9A%84Java%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E8%84%9A%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Locatino">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LOCATINO'S NOTE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/06/29/%E4%B8%80%E4%B8%AA%E9%80%9A%E7%94%A8%E7%9A%84Java%E7%A8%8B%E5%BA%8F%E6%8E%A7%E5%88%B6%E8%84%9A%E6%9C%AC/" class="post-title-link" itemprop="url">一个通用的Java程序控制脚本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2015-06-29 15:06:12" itemprop="dateCreated datePublished" datetime="2015-06-29T15:06:12+08:00">2015-06-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2022-08-31 20:11:00" itemprop="dateModified" datetime="2022-08-31T20:11:00+08:00">2022-08-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Memo/" itemprop="url" rel="index"><span itemprop="name">Memo</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>修改相应的参数就可以很方便的控制各类Java程序。<br>将脚本置于bin目录下，<br>推荐目录格式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; application</span><br><span class="line">&gt; bin</span><br><span class="line">&gt; lib</span><br><span class="line">&gt; log</span><br><span class="line">&gt; conf</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">#! /bin/sh</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># 定义变量</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">libdir=../lib</span><br><span class="line"># 模块名(程序的唯一标识)</span><br><span class="line">MODEL_NAME=test</span><br><span class="line"># 模块运行需要的lib</span><br><span class="line">MODEL_LIBS=`./stoc.sh $&#123;libdir&#125;`</span><br><span class="line"># 选项(java启动参数)</span><br><span class="line">MODEL_OPTS=&quot;-Xmx128m -DConfig=../conf/db.xml -DtaskConfig=../conf/taskConfig.xml -Dlog4j.configuration=file:../conf/cmdcenter.log4j&quot;</span><br><span class="line"># 运行类名(main函数所在类)</span><br><span class="line">MODEL_CLASS=&quot;com.locatino.server.TestServer&quot;</span><br><span class="line"># 运行参数</span><br><span class="line">MODEL_VARS=&quot;0&quot;</span><br><span class="line"># 前台/后台: 0-前台， 1-后台</span><br><span class="line">MODEL_DAEMON=1</span><br><span class="line"># 日志 &#x27;&amp;-&#x27;:表示关闭标准输出日志</span><br><span class="line">MODEL_LOG=&quot;../log/error.log&quot;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># 以下内容请不要修改</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">SLEEP_MIN=5</span><br><span class="line"># model info can be define here</span><br><span class="line">MODEL_SYMBOL=$&#123;MODEL_NAME&#125;</span><br><span class="line">GREP_KEY=&quot;Diname=&quot;$&#123;MODEL_SYMBOL&#125;</span><br><span class="line"># CLASSPATH can bu define here</span><br><span class="line">CLASSPATH=$&#123;MODEL_LIBS&#125;:.:$&#123;CLASSPATH&#125;</span><br><span class="line">#----------------------------------------------------------</span><br><span class="line"># function print usage</span><br><span class="line">#----------------------------------------------------------</span><br><span class="line">print_usage()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&quot;</span><br><span class="line">echo &quot;\th|H|help|HELP \tPrint help information.&quot;</span><br><span class="line">echo &quot;\tstart \tStart the $&#123;MODEL_NAME&#125; server.&quot;</span><br><span class="line">echo &quot;\tstop \tStop the $&#123;MODEL_NAME&#125; server.&quot;</span><br><span class="line">echo &quot;\tstatus \tStatus the $&#123;MODEL_NAME&#125; server.&quot;</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># function model_is_exist</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">modelService_is_exist()</span><br><span class="line">&#123;</span><br><span class="line">localServerId=`ps -ef |grep &quot;$&#123;GREP_KEY&#125;&quot; | grep -v grep | awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ -z &quot;$&#123;localServerId&#125;&quot; ]</span><br><span class="line">then</span><br><span class="line">return 1</span><br><span class="line">else</span><br><span class="line">return 0</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># function model_start</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">model_start ()</span><br><span class="line">&#123;</span><br><span class="line">modelService_is_exist</span><br><span class="line">if [ $? -eq &quot;0&quot; ]</span><br><span class="line">then</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; is running yet. pid $&#123;localServerId&#125;.&quot;</span><br><span class="line">return 0</span><br><span class="line">else</span><br><span class="line">if [ $MODEL_DAEMON = 0 ]</span><br><span class="line">then</span><br><span class="line">echo &quot;try to start $&#123;MODEL_NAME&#125; ... foreground&quot;</span><br><span class="line">$JAVA_HOME/bin/java -$&#123;GREP_KEY&#125; -classpath $&#123;CLASSPATH&#125; $&#123;MODEL_OPTS&#125; $&#123;MODEL_CLASS&#125; $&#123;MODEL_VARS&#125;</span><br><span class="line">else</span><br><span class="line">echo &quot;try to start $&#123;MODEL_NAME&#125; ... backgroud&quot;</span><br><span class="line">nohup $JAVA_HOME/bin/java -$&#123;GREP_KEY&#125; $&#123;MODEL_OPTS&#125; -classpath $&#123;CLASSPATH&#125; $&#123;MODEL_CLASS&#125; $&#123;MODEL_VARS&#125; 1&gt;&amp;- 2&gt;&gt;$&#123;MODEL_LOG&#125; &amp;</span><br><span class="line">sleep $SLEEP_MIN</span><br><span class="line">modelService_is_exist</span><br><span class="line">if [ $? -eq &quot;0&quot; ]</span><br><span class="line">then</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; is running now. pid $&#123;localServerId&#125;.&quot;</span><br><span class="line">return 0</span><br><span class="line">else</span><br><span class="line">echo &quot;failed to start $&#123;MODEL_NAME&#125;! see the output log for more details.&quot;</span><br><span class="line">return 1</span><br><span class="line">fi</span><br><span class="line">fi</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># function model_stop</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">model_stop()</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;try to stop $&#123;MODEL_NAME&#125; ...&quot;</span><br><span class="line">modelService_is_exist</span><br><span class="line">if [ $? -eq 0 ]</span><br><span class="line">then</span><br><span class="line">/usr/bin/kill $&#123;localServerId&#125;</span><br><span class="line">if [ $? -ne 0 ]</span><br><span class="line">then</span><br><span class="line">echo &quot;failed to stop $&#123;MODEL_NAME&#125;!&quot;</span><br><span class="line">return 1</span><br><span class="line">else</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; stopped.&quot;</span><br><span class="line">return 0</span><br><span class="line">fi</span><br><span class="line">else</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; is not running!&quot;</span><br><span class="line">return 1</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># function model_status</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">model_status()</span><br><span class="line">&#123;</span><br><span class="line">modelService_is_exist</span><br><span class="line">if [ $? -eq 0 ]</span><br><span class="line">then</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; is running. pid $&#123;localServerId&#125;.&quot;</span><br><span class="line">else</span><br><span class="line">echo &quot;$&#123;MODEL_NAME&#125; is not running.&quot;</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">#</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># function parse_para</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">parse_para()</span><br><span class="line">&#123;</span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">start) model_start;;</span><br><span class="line">stop) model_stop;;</span><br><span class="line">status) model_status;;</span><br><span class="line">*) echo &quot;illage parameter : $1&quot;;print_usage;;</span><br><span class="line">esac</span><br><span class="line">&#125;</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line"># main</span><br><span class="line">#-------------------------------------------------------------------</span><br><span class="line">parse_para $1</span><br></pre></td></tr></table></figure>
<p>下面是stoc.sh</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `find $1 -name &quot;*.jar&quot;` | sed -e &#x27;s/ /:/g&#x27;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Locatino</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Locatino</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 強力驅動
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
